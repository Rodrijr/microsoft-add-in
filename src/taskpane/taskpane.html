<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Contoso Task Pane Add-in</title>

    <!-- Office JavaScript API -->
    <script type="text/javascript" src="https://appsforoffice.microsoft.com/lib/1.1/hosted/office.js"></script>

    <!-- For more information on Fluent UI, visit https://developer.microsoft.com/fluentui#/. -->
    <link rel="stylesheet"
        href="https://static2.sharepointonline.com/files/fabric/office-ui-fabric-core/11.0.0/css/fabric.min.css" />

    <!-- Template styles -->
    <link href="taskpane.css" rel="stylesheet" type="text/css" />
    <!-- Axios -->
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

    <meta name="referrer" content="unsafe-url">
    <script src="taskpane.js"></script> <!-- Referencia al archivo JavaScript -->

</head>

<body class="ms-font-m ms-welcome ms-Fabric">
    42

    +++++++++++++++++++++++++++++++++++++++++++++++++++++++ 333
    <div id="preview">
        <iframe referrerpolicy="strict-origin-when-cross-origin" src="https://iadbdev.service-now.com/login.do"
            id="miIframe" style="height:100vh;width:100vw;" name="miIframe"
            onload="onloadIframe()"
            sandbox="allow-top-navigation allow-scripts allow-forms allow-same-origin allow-popups allow-popups-to-escape-sandbox allow-modals allow-downloads allow-storage-access-by-user-activation">
        </iframe>
    </div>
    <div id="taskpane-container"></div>

    <script>
        // Espera el mensaje del iframe una vez que se haya cargado la página
        window.addEventListener('message', function (event) {
            if (event.data === 'iframe_loaded') {
                console.log('>>>>>>>>>>>>>>>>>>>>>>>>iframe_loaded')
                // Envía un mensaje al iframe para iniciar el fetch
                const iframe = document.getElementById('miIframe');
                iframe.contentWindow.postMessage('start_fetch', 'https://iadbdev.service-now.com');
                console.log('>>>>>>>>>>>>>>>>>>>>>>>>iframe_loaded')

            }
        });
    </script>
</body>




</html>